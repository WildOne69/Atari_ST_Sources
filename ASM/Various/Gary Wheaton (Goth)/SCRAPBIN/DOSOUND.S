
; FOR INCLUSION, DON'T RUN AS IS

; G.W. 1988
; dosound without TRAPping
; call from vbi etc bsr ssrr
; use like such....

SOUND0 
 MOVE.L #BANG,SUND
 CLR.L SAND
 RTS


;DATA FOR A SOUND

BANG DC.B 3,3,9,16,13,1,12,55
 DC.B $80,10,$81,3,2,0,255,0

 even

SUND DC.L 0
SAND DC.L 0




;--------DO-SOUND ROUTINE--FROM R.O.M.
;----CALL REGULARLY, OR USE IN VB ETC


SSRR 
 MOVE.L SUND,D0
 BEQ FF1

 MOVE.L D0,A0
 MOVE.B SAND,D0
 BEQ FF2
 SUBQ.B #1,D0
 MOVE.B D0,SAND
 BRA FF1
FF2 MOVE.B (A0)+,D0
 BMI FF4
 MOVE.B D0,D5
 MOVE.B D0,$FFFF8800
 CMP.B #7,D0
 BNE FF5
 MOVE.B (A0)+,D1
 AND.B #$3F,D1
 MOVE.B $FF8800,D0
SSD AND.B #$C0,D0
 OR.B D1,D0
 MOVE.B D0,$FF8802
 BRA FF2
FF5 MOVE.B (A0)+,$FFFF8802
 BRA FF2
FF4 ADDQ.B #1,D0
 BPL FF8
 CMP.B #$81,D0
 BNE FF9
 MOVE.B (A0)+,SAND+1
 BRA FF2
FF9 CMP.B #$82,D0
 BNE FF8
 MOVE.B (A0)+,$FF8800
 MOVE.B (A0)+,D0
 ADD.B D0,SAND+1
 MOVE.B (A0)+,D0
 MOVE.B SAND+1,$FFFF8802
 CMP.B SAND+1,D0
 BEQ FF12
 SUBQ #4,A0
 BRA FF12
FF8 MOVE.B (A0)+,SAND
 BNE FF12
 MOVE #0,A0
FF12 MOVE.L A0,SUND

FF1 RTS
;\\\\\\\\\
