 1: * ISTFEI.CMD
 2: 
 3: ***** PARAMATER / GLOBALE VARIABLE
 4: SET TALK OFF
 5: SET DB3 ON
 6: X.DAT = DATE()
 7: X.MO = 'EXTRACT(",","Januar,Februar,M„rz,April,Mai,Juni,Juli,August,September,Oktober,November,Dezember",MONTH(X.DAT))'
 8: X.WOT ='EXTRACT(",","Sonntag,Montag,Dienstag,Mittwoch,Donnerstag,Freitag,Samstag",DOW(X.DAT))'
 9: 
10: DO WHILE .T.
11: ERASE
12: ***** EINGABE
13: X.SDAT = DATE()
14: @ 2,5 SAY 'GESUCHTER TAG: ' GET X.SDAT PICT '##.##.####' VALID NRANGE(YEAR(X.SDAT),1989,2039) ;
15:                                 ERRMSG ' DATUM AUSSERHALB DES DERZEITIGEN RECHENBEREICHES (1989-2035)'        
16: @ 21,1 SAY'ENDE MIT  ESC'
17: @ 3,0 TO 3,80
18: READ
19: ***** EXIT BEDINGUNG
20:     IF LASTKEY() = 27 
21:         RETURN
22:     ENDIF
23: X.DAT = X.SDAT
24: @ ROW()+1,5 SAY &X.MO
25: @ ROW()+1,5 SAY &X.WOT
26:      
27: ***** BERECHNUNG DES JEWEILIGEN OSTERDATUMS 
28: Y.JAHR =YEAR(X.SDAT)
29: Y.VAR = IIFN(Y.JAHR-1989=0,1,((Y.JAHR-1989)*5)+1)
30: Y.D = MOD(19*MOD(Y.JAHR,19)+24,30)
31: Y.E = MOD(2*MOD(Y.JAHR,4)+4*MOD(Y.JAHR,7)+6*Y.D+IIFN(NRANGE(Y.JAHR,1900,2035),5,6),7)
32: X.DOST = CTOD(STR(22+Y.D+Y.E,2,0)+'.03.'+STR(Y.JAHR,4,0))
33: 
34: ***** ASCHERMITTWOCH/LISTE/REFERENZDATUM
35: Y.DAMI=X.DOST-46
36: Y.FLISTE='ROSENMONTAG/KARFREITAG/OSTERMONTAG/CHR.HIMMELF./PFINGSTMONTAG/;
37: FRONLEICHNAM/3 K™NIG/TAG DER ARBEIT/17.JUNI/MARIA HIMMELF./;
38: ALLERHEILIGEN/HL.ABEND/1.FEIERT./2.FEIERT./BUž+BETTAG'    
39: Y.J1=CTOD('01.01.'+STR(Y.JAHR,4,0))   
40: 
41: ***** BERECHNUNG DER FEIERTAGE FšR DAS GANZE JAHR
42: Y.ND0=X.SDAT-Y.J1
43: Y.ND1=Y.DAMI-2-Y.J1
44: Y.ND2=Y.DAMI+44-Y.J1
45: Y.ND3=Y.DAMI+47-Y.J1
46: Y.ND4=Y.DAMI+85-Y.J1
47: Y.ND5=Y.DAMI+96-Y.J1
48: Y.ND6=Y.DAMI+106-Y.J1
49: Y.ND7=CTOD('07.01.'+STR(Y.JAHR,4,0))-Y.J1
50: Y.ND8=CTOD('01.05.'+STR(Y.JAHR,4,0))-Y.J1
51: Y.ND9=CTOD('17.06.'+STR(Y.JAHR,4,0))-Y.J1
52: Y.ND10=CTOD('15.08.'+STR(Y.JAHR,4,0))-Y.J1
53: Y.ND11=CTOD('01.11.'+STR(Y.JAHR,4,0))-Y.J1
54: Y.ND12=CTOD('24.12.'+STR(Y.JAHR,4,0))-Y.J1
55: Y.ND13=CTOD('25.12.'+STR(Y.JAHR,4,0))-Y.J1
56: Y.ND14=CTOD('26.12.'+STR(Y.JAHR,4,0))-Y.J1
57: Y.ND15=(Y.J1+46*7-DOW(Y.J1)+4)-Y.J1
58: 
59: Y.NLISTE=NLIST(Y.ND0,Y.ND1,Y.ND2,Y.ND3,Y.ND4,Y.ND5,Y.ND6,Y.ND7,Y.ND8,Y.ND9,Y.ND10,Y.ND11,Y.ND12,Y.ND13,Y.ND14,Y.ND15)
60: X.FEIERT=EXTRACT('/',Y.FLISTE,Y.NLISTE)
61:         @ ROW()+2,5 SAY IIFC(Y.NLISTE<>0,X.FEIERT,'')
62: WAIT
63: ENDDO
64: RETURN

